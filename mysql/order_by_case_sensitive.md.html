<html><head><title>MySQL的order by时区分大小写 | 大象的blog</title><meta name="viewport" content="width=device-width, initial-scale=1" /><link href="/md-blog/static/markdown.css" rel="stylesheet" type="text/css" /></head><body><div class="markdown-content"><h1>MySQL的order by时区分大小写</h1>
<p>MySQL默认的order by是不区分大小写的。
如果我们希望使用区分大小写的order by，
该怎么办呢？</p>
<h2>先看一个例子。</h2>
<p>表结构：</p>
<pre><code>create table test_collate(
   `id` int NOT NULL AUTO_INCREMENT,
   `text` varchar(40) NOT NULL,
   PRIMARY KEY (`id`)
)ENGINE=MyISAM DEFAULT CHARSET=utf8;
</code></pre>
<p>插入数据：</p>
<pre><code>insert into test_collate(`text`) values('aaa'),('bbb'),('AAA'),('BBB');
</code></pre>
<p>现在，如果我们按照text排序：</p>
<pre><code>select * from test_collate order by text;
</code></pre>
<p>结果：</p>
<pre><code>+----+------+
| id | text |
+----+------+
|  1 | aaa  |
|  3 | AAA  |
|  2 | bbb  |
|  4 | BBB  |
+----+------+
</code></pre>
<p>结果表明，大写的AAA和小写的aaa被认为是一样的，
都排在BBB和bbb前面。</p>
<h2>为什么呢？</h2>
<p>这里涉及到一个重要的概念，叫collate。
collate是一个与charset有关的概念，
它会影响到很多事情，
其中就包括排序的规则。</p>
<p>在《MySQL必知必会》中对collate有过详细的介绍，
我们就不在这里去介绍它了。</p>
<h2>如何解决</h2>
<p>解决方案有两个：</p>
<ol>
<li>将test_collate表的collate改成case sensitive的</li>
<li>使用case sensitive的collate进行order by</li>
</ol>
<p>这里，我们不希望改变表结构，
只是临时地order by一下，
因为使用方案2。</p>
<p>代码如下：</p>
<pre><code>select * from test_collate order by text collate utf8_bin;
</code></pre>
<p>结果如下：</p>
<pre><code>+----+------+
| id | text |
+----+------+
|  3 | AAA  |
|  4 | BBB  |
|  1 | aaa  |
|  2 | bbb  |
+----+------+
</code></pre></div><div class="bottom-area"><a href="/md-blog/catalog.html">目录</a><a class="btn-idontknow" href="#">啦啦啦</a></div></body></html>